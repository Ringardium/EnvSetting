listen              1935;
max_connections     1000;
daemon              off;
srs_log_tank        console;
srs_log_level       error;

http_server {
    enabled         on;
    listen          8080;
    dir             /hls;
    crossdomain     on;
}

http_api {
    enabled         on;
    listen          1985;
}

srt_server {
    enabled         on;
    listen          10080;
    maxbw           1000000000;
    connect_timeout 4000;
    peerlatency     100;
    recvlatency     100;
}

#==============================================================
# 국내 고객사 (kr.example.com) - SRT 직접 (저지연)
#==============================================================
vhost kr.example.com {
    srt {
        enabled     on;
        srt_to_rtmp on;
    }

    play {
        gop_cache       off;
        queue_length    10;
    }

    hls {
        enabled         off;
    }

    dvr {
        enabled         off;
    }

 #   dvr {
 #       enabled             on;
 #       dvr_apply           all;
 #       dvr_path            /recordings/[vhost]/[app]/[stream]/[2006]/[01]/[02]/[15]-[04]-[05].mp4;
 #       dvr_plan            segment;
 #       dvr_duration        600;
 #       dvr_wait_keyframe   on;
 #   }
}

#==============================================================
# 해외 고객사 (intl.example.com) - HLS/CDN (안정성)
#==============================================================
vhost intl.example.com {
    srt {
        enabled     on;
        srt_to_rtmp on;
    }

    play {
        gop_cache       on;
        queue_length    30;
    }

    hls {
        enabled             on;
        hls_fragment        2;
        hls_window          5;
        hls_path            /hls;
        hls_m3u8_file       [vhost]/[app]/[stream]/index.m3u8;
        hls_ts_file         [vhost]/[app]/[stream]/[seq].ts;
        hls_cleanup         on;
        hls_dispose         10;
    }

    dvr {
        enabled off;
    #    enabled             on;
    #    dvr_path            /recordings/[vhost]/[app]/[stream]/[2006]/[01]/[02]/[15]-[04]-[05].mp4;
    #    dvr_plan            segment;
    #    dvr_duration        600;
    #    dvr_wait_keyframe   on;
    }
}

#==============================================================
# 기본 vhost (테스트용)
#==============================================================
vhost __defaultVhost__ {
    srt {
        enabled     on;
        srt_to_rtmp on;
    }

    hls {
        enabled     off;
    }

    dvr {
        enabled     off;
    }
}
